<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Thermodynamics · Breeze</title><meta name="title" content="Thermodynamics · Breeze"/><meta property="og:title" content="Thermodynamics · Breeze"/><meta property="twitter:title" content="Thermodynamics · Breeze"/><meta name="description" content="Documentation for Breeze."/><meta property="og:description" content="Documentation for Breeze."/><meta property="twitter:description" content="Documentation for Breeze."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Breeze</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Thermodynamics</a><ul class="internal"><li><a class="tocitem" href="#Two-laws-for-ideal-gases"><span>Two laws for ideal gases</span></a></li><li><a class="tocitem" href="#An-example-of-a-dry-reference-state-in-Breeze"><span>An example of a dry reference state in Breeze</span></a></li><li><a class="tocitem" href="#Thermodynamic-relations-for-gaseous-mixtures"><span>Thermodynamic relations for gaseous mixtures</span></a></li><li><a class="tocitem" href="#The-Clausius–Clapeyron-relation-and-saturation-specific-humidity"><span>The Clausius–Clapeyron relation and saturation specific humidity</span></a></li></ul></li><li><span class="tocitem">Microphysics</span><ul><li><a class="tocitem" href="../microphysics/microphysics_overview/">Overview</a></li><li><a class="tocitem" href="../microphysics/saturation_adjustment/">Warm phase saturation adjustment</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Thermodynamics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Thermodynamics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl/blob/main/docs/src/thermodynamics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Atmosphere-Thermodynamics"><a class="docs-heading-anchor" href="#Atmosphere-Thermodynamics">Atmosphere Thermodynamics</a><a id="Atmosphere-Thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Atmosphere-Thermodynamics" title="Permalink"></a></h1><p>Breeze implements thermodynamic relations for moist atmospheres – fluids that can be described as a binary mixture of <em>(i)</em> &quot;dry&quot; air, and <em>(ii)</em> vapor, as well as liquid and solid condensates of the vapor component of various shapes and sizes.</p><p>On Earth, dry air is itself a mixture of gases, the vapor component is <span>$\mathrm{H_2 O}$</span>, and the condensates comprise clouds and precipitation such as rain, snow, hail, and grapuel. Breeze models dry air as having a fixed composition with constant <a href="https://en.wikipedia.org/wiki/Molar_mass">molar mass</a>. Dry air on Earth&#39;s is mostly nitrogen, oxygen, and argon.</p><h2 id="Two-laws-for-ideal-gases"><a class="docs-heading-anchor" href="#Two-laws-for-ideal-gases">Two laws for ideal gases</a><a id="Two-laws-for-ideal-gases-1"></a><a class="docs-heading-anchor-permalink" href="#Two-laws-for-ideal-gases" title="Permalink"></a></h2><p>Both dry air and vapor are modeled as ideal gases, which means that the <a href="https://en.wikipedia.org/wiki/Ideal_gas_law">ideal gas law</a> relates pressure <span>$p$</span>, temperature <span>$T$</span>, and density <span>$ρ$</span>,</p><p class="math-container">\[p = ρ R T .\]</p><p>Above, <span>$R ≡ ℛ / m$</span> is the specific gas constant given the <a href="https://en.wikipedia.org/wiki/Gas_constant">molar or &quot;universal&quot; gas constant</a> <span>$ℛ ≈ 8.31 \; \mathrm{J} \, \mathrm{K}^{-1} \, \mathrm{mol}^{-1}$</span> and molar mass <span>$m$</span> of the gas species under consideration.</p><p>The <a href="https://en.wikipedia.org/wiki/First_law_of_thermodynamics">first law of thermodynamics</a>, aka &quot;conservation of energy&quot;, states that an infinitesimal change in the external heat changes <span>$\mathrm{d} \mathcal{Q}$</span> are related to infinitesimal changes in temperature <span>$\mathrm{d} T$</span> and pressure <span>$\mathrm{d} p$</span> according to:<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><p class="math-container">\[\mathrm{d} \mathcal{Q} = cᵖ \mathrm{d} T - \frac{\mathrm{d} p}{\rho} ,\]</p><p>where <span>$cᵖ$</span> is the specific heat capacity at constant pressure of the gas in question.</p><p>For example, to represent dry air typical for Earth, with molar mass <span>$m = 0.029 \; \mathrm{kg} \, \mathrm{mol}^{-1}$</span> and heat capacity <span>$c^p = 1005 \; \mathrm{J} \, \mathrm{kg}^{-1} \, \mathrm{K}^{-1}$</span>, we write</p><pre><code class="language-julia hljs">using Breeze.Thermodynamics: IdealGas
dry_air = IdealGas(molar_mass=0.029, heat_capacity=1005)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">IdealGas{Float64}(molar_mass=0.029, heat_capacity=1005.0)</code></pre><h3 id="Adiabatic-transformations-and-potential-temperature"><a class="docs-heading-anchor" href="#Adiabatic-transformations-and-potential-temperature">Adiabatic transformations and potential temperature</a><a id="Adiabatic-transformations-and-potential-temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Adiabatic-transformations-and-potential-temperature" title="Permalink"></a></h3><p>Within adiabatic transformations, <span>$\mathrm{d} \mathcal{Q} = 0$</span>. Then, combining the ideal gas law with conservation of energy yields</p><p class="math-container">\[\frac{\mathrm{d} T}{T} = \frac{R}{cᵖ} \frac{\mathrm{d} p}{p} ,\]</p><p>which implies that <span>$T ∼ ( p / p₀ )^{R / cᵖ}$</span>, where <span>$p₀$</span> is some reference pressure value.</p><p>As a result, the <em>potential temperature</em>, <span>$θ$</span>, defined as</p><p class="math-container">\[θ ≡ T \big / \left ( \frac{p}{p₀} \right )^{R / cᵖ} = \frac{T}{Π} ,\]</p><p>remains constant under adiabatic transformations. Notice that above, we also defined the Exner function, <span>$Π ≡ ( p / p₀ )^{R / cᵖ}$</span>. By convention, we tend to use as reference values those at the surface <span>$z=0$</span>, i.e., <span>$p₀ = p(z=0)$</span>, <span>$T₀ = T(z=0)$</span>, etc. This implies that the potential temperature under adiabatic transformation is <span>$θ(z) = θ₀ = T₀$</span>.</p><p>(Superscript <span>$d$</span> denotes dry air, e.g., <span>$Rᵈ = 286.71 \; \mathrm{J} \, \mathrm{K}^{-1}$</span>.)</p><h3 id="Hydrostatic-balance"><a class="docs-heading-anchor" href="#Hydrostatic-balance">Hydrostatic balance</a><a id="Hydrostatic-balance-1"></a><a class="docs-heading-anchor-permalink" href="#Hydrostatic-balance" title="Permalink"></a></h3><p>Next we consider a reference state that does not exchange energy with its environment (i.e., <span>$\mathrm{d} \mathcal{Q} = 0$</span>) and thus has constant potential temperature</p><p class="math-container">\[θ₀ = Tᵣ \left ( \frac{p₀}{pᵣ} \right )^{Rᵈ / cᵖᵈ} .\]</p><div class="admonition is-info" id="About-subscripts-235e766617342871"><header class="admonition-header">About subscripts<a class="admonition-anchor" href="#About-subscripts-235e766617342871" title="Permalink"></a></header><div class="admonition-body"><p>Subscripts <span>$0$</span> typically indicate evaluated values. For example, in the above formula, <span>$p₀ ≡ pᵣ(z=0)$</span>. Subscripts <span>$r$</span> indicate <em>reference</em> states, which typically are functions of <span>$z$</span>. This differs from the usual notation in which the subscripts <span>$0$</span> indicate &quot;reference&quot; and &quot;00&quot; means <span>$z=0$</span>.</p></div></div><p>Hydrostatic balance requires</p><p class="math-container">\[∂_z pᵣ = - ρᵣ g .\]</p><p>By combining the hydrostatic balance with the ideal gas law and the definition of potential temperature we get</p><p class="math-container">\[\frac{pᵣ}{p₀} = \left (1 - \frac{g z}{cᵖᵈ θ₀} \right )^{cᵖᵈ / Rᵈ} .\]</p><p>Thus</p><p class="math-container">\[Tᵣ(z) = θ₀ \left ( \frac{pᵣ}{p₀} \right )^{Rᵈ / cᵖᵈ} = θ₀ \left ( 1 - \frac{g z}{cᵖᵈ θ₀} \right ) ,\]</p><p>and</p><p class="math-container">\[ρᵣ(z) = \frac{p₀}{Rᵈ θ₀} \left ( 1 - \frac{g z}{cᵖᵈ θ₀} \right )^{cᵖᵈ / Rᵈ - 1} .\]</p><h2 id="An-example-of-a-dry-reference-state-in-Breeze"><a class="docs-heading-anchor" href="#An-example-of-a-dry-reference-state-in-Breeze">An example of a dry reference state in Breeze</a><a id="An-example-of-a-dry-reference-state-in-Breeze-1"></a><a class="docs-heading-anchor-permalink" href="#An-example-of-a-dry-reference-state-in-Breeze" title="Permalink"></a></h2><p>We can visualise a hydrostatic reference profile evaluating Breeze&#39;s reference-state utilities (which assume a dry reference state) on a one-dimensional <code>RectilinearGrid</code>:</p><pre><code class="language-julia hljs">using Breeze
using Breeze.Thermodynamics: reference_pressure, reference_density
using CairoMakie

thermo = ThermodynamicConstants()
constants = ReferenceStateConstants(base_pressure=101325, potential_temperature=288)
grid = RectilinearGrid(size=160, z=(0, 12_000), topology=(Flat, Flat, Bounded))

pᵣ = CenterField(grid)
ρᵣ = CenterField(grid)

set!(pᵣ, z -&gt; reference_pressure(z, constants, thermo))
set!(ρᵣ, z -&gt; reference_density(z, constants, thermo))

Rᵈ = Breeze.Thermodynamics.dry_air_gas_constant(thermo)
cᵖᵈ = thermo.dry_air.heat_capacity
p₀ = constants.base_pressure
θ₀ = constants.reference_potential_temperature
g = thermo.gravitational_acceleration

# Verify that Tᵣ = θ₀ (1 - g z / (cᵖᵈ θ₀))
z = KernelFunctionOperation{Center, Center, Center}(znode, grid, Center(), Center(), Center())
Tᵣ₁ = Field(θ₀ * (pᵣ / p₀)^(Rᵈ / cᵖᵈ))
Tᵣ₂ = Field(θ₀ * (1 - g * z / (cᵖᵈ * θ₀)))

fig = Figure()

axT = Axis(fig[1, 1]; xlabel = &quot;Temperature (ᵒK)&quot;, ylabel = &quot;Height (m)&quot;)
lines!(axT, Tᵣ₁)
lines!(axT, Tᵣ₂, linestyle = :dash, color = :orange, linewidth = 2)

axp = Axis(fig[1, 2]; xlabel = &quot;Pressure (10⁵ Pa)&quot;, yticklabelsvisible = false)
lines!(axp, pᵣ / 1e5)

axρ = Axis(fig[1, 3]; xlabel = &quot;Density (kg m⁻³)&quot;, yticklabelsvisible = false)
lines!(axρ, ρᵣ)

fig</code></pre><img src="f1e56f04.svg" alt="Example block output"/><h2 id="Thermodynamic-relations-for-gaseous-mixtures"><a class="docs-heading-anchor" href="#Thermodynamic-relations-for-gaseous-mixtures">Thermodynamic relations for gaseous mixtures</a><a id="Thermodynamic-relations-for-gaseous-mixtures-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamic-relations-for-gaseous-mixtures" title="Permalink"></a></h2><p>&quot;Moist air&quot; is conceived to be a mixture of two gas phases: &quot;dry air&quot; (itself a mixture of gases) and water vapor, as well as a collection of liquid droplet and solid ice particle &quot;condensates&quot;. We assume that the volume of the condensates is negligible, such that the total pressure is the sum of partial pressures of vapor and dry air,</p><p class="math-container">\[p = pᵈ + pᵛ .\]</p><p>(Superscripts <span>$d$</span> and <span>$v$</span> denote dry air and vapor respectively.)</p><p>The partial pressure of the dry air and vapor components are related to the component densities <span>$ρᵈ$</span> and <span>$ρᵛ$</span> through the ideal gas law,</p><p class="math-container">\[pᵈ = ρᵈ Rᵈ T \qquad \text{and} \qquad pᵛ = ρᵛ Rᵛ T ,\]</p><p>where <span>$T$</span> is temperature, <span>$Rⁱ = ℛ / m^β$</span> is the specific gas constant for component <span>$β$</span>, <span>$ℛ$</span>  is the <a href="https://en.wikipedia.org/wiki/Gas_constant">molar or &quot;universal&quot; gas constant</a>, and <span>$m^β$</span> is the molar mass of component <span>$β$</span>.</p><p>Central to Breeze&#39;s implementation of moist thermodynamics is a struct that holds parameters like the molar gas constant and molar masses,</p><pre><code class="language-julia hljs">thermo = ThermodynamicConstants()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ThermodynamicConstants{Float64}:
├── molar_gas_constant: 8.314462618
├── gravitational_acceleration: 9.81
├── energy_reference_temperature: 273.16
├── triple_point_temperature: 273.16
├── triple_point_pressure: 611.657
├── dry_air: IdealGas{Float64}(molar_mass=0.02897, heat_capacity=1005.0)
├── vapor: IdealGas{Float64}(molar_mass=0.018015, heat_capacity=1850.0)
├── liquid: CondensedPhase{Float64}(latent_heat=2.5008e6, heat_capacity=4181.0)
└── solid: CondensedPhase{Float64}(latent_heat=2.834e6, heat_capacity=2108.0)</code></pre><p>The default parameter evince basic facts about water vapor air typical to Earth&#39;s atmosphere: for example, the molar masses of dry air (itself a mixture of mostly nitrogen, oxygen, and argon), and water vapor are <span>$mᵈ = 0.029 \; \mathrm{kg} \, \mathrm{mol}^{-1}$</span> and <span>$mᵛ = 0.018 \; \mathrm{kg} \, \mathrm{mol}^{-1}$</span>.</p><p>To write the effective gas law for moist air, we introduce the mass ratios, e.g., specific humidity and specific hydrometeor contents,</p><p class="math-container">\[qᵈ ≡ \frac{ρᵈ}{ρ} \qquad \text{and} \qquad qᵛ ≡ \frac{ρᵛ}{ρ} ,\]</p><p>where <span>$ρ$</span> is total density of the fluid including dry air, vapor, and condensates, <span>$ρᵈ$</span> is the density of dry air, and <span>$ρᵛ$</span> is the density of vapor. It&#39;s then convenient to introduce the &quot;mixture&quot; gas constant <span>$Rᵐ(qᵛ)$</span> such that</p><p class="math-container">\[p = ρ Rᵐ T, \qquad \text{where} \qquad Rᵐ ≡ qᵈ Rᵈ + qᵛ Rᵛ .\]</p><p>In &quot;clear&quot; (not cloudy) air, we have that <span>$qᵈ = 1 - qᵛ$</span>. More generally, <span>$qᵈ = 1 - qᵛ - qᶜ$</span>, where <span>$qᶜ$</span> is the total mass ratio of condensed species. In most situations on Earth, <span>$qᶜ ≪ qᵛ$</span>.</p><pre><code class="language-julia hljs"># Compute mixture properties for air with 0.01 specific humidity
qᵛ = 0.01 # 1% water vapor by mass
Rᵐ = mixture_gas_constant(qᵛ, thermo)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">288.7477814111527</code></pre><p>We likewise define a mixture heat capacity via <span>$cᵖᵐ = qᵈ cᵖᵈ + qᵛ cᵖᵛ$</span>,</p><pre><code class="language-julia hljs">q = 0.01 # 1% water vapor by mass
cᵖᵐ = mixture_heat_capacity(qᵛ, thermo)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1013.45</code></pre><h2 id="The-Clausius–Clapeyron-relation-and-saturation-specific-humidity"><a class="docs-heading-anchor" href="#The-Clausius–Clapeyron-relation-and-saturation-specific-humidity">The Clausius–Clapeyron relation and saturation specific humidity</a><a id="The-Clausius–Clapeyron-relation-and-saturation-specific-humidity-1"></a><a class="docs-heading-anchor-permalink" href="#The-Clausius–Clapeyron-relation-and-saturation-specific-humidity" title="Permalink"></a></h2><p>The <a href="https://en.wikipedia.org/wiki/Clausius%E2%80%93Clapeyron_relation">Clausius–Clapeyron relation</a> for an ideal gas</p><p class="math-container">\[\frac{\mathrm{d} pᵛ⁺}{\mathrm{d} T} = \frac{pᵛ⁺ ℒ^β(T)}{Rᵛ T^2} ,\]</p><p>where <span>$pᵛ⁺$</span> is saturation vapor pressure, <span>$T$</span> is temperature, <span>$Rᵛ$</span> is the specific gas constant for vapor, <span>$ℒ^β(T)$</span> is the latent heat of the transition from vapor to the <span>$β$</span> phase (e.g., <span>$β = l$</span> for vapor → liquid and <span>$β = i$</span> for vapor to ice).</p><p>For a thermodynamic formulation that uses constant (i.e. temperature-independent) specific heats, the latent heat of a phase transition is linear in temperature. For example, for phase change from vapor to liquid,</p><p class="math-container">\[ℒˡ(T) = ℒˡ(T=0) + \big ( \underbrace{cᵖᵛ - cᵖˡ}_{≡Δcˡ} \big ) T ,\]</p><p>where <span>$ℒˡ(T=0)$</span> is the latent heat at absolute zero, <span>$T = 0 \; \mathrm{K}$</span>. By integrating from the triple-point temperature <span>$Tᵗʳ$</span> for which <span>$p(Tᵗʳ) = pᵗʳ$</span>, we get</p><p class="math-container">\[pᵛ⁺(T) = pᵗʳ \left ( \frac{T}{Tᵗʳ} \right )^{Δcˡ / Rᵛ} \exp \left [ \frac{ℒˡ(T=0)}{Rᵛ} \left (\frac{1}{Tᵗʳ} - \frac{1}{T} \right ) \right ] .\]</p><p>Consider parameters for liquid water,</p><pre><code class="language-julia hljs">using Breeze.Thermodynamics: CondensedPhase
liquid_water = CondensedPhase(latent_heat=2500800, heat_capacity=4181)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CondensedPhase{Float64}(latent_heat=2.5008e6, heat_capacity=4181.0)</code></pre><p>or water ice,</p><pre><code class="language-julia hljs">water_ice = CondensedPhase(latent_heat=2834000, heat_capacity=2108)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CondensedPhase{Float64}(latent_heat=2.834e6, heat_capacity=2108.0)</code></pre><p>The saturation vapor pressure is</p><pre><code class="language-julia hljs">using Breeze
using Breeze.Thermodynamics: saturation_vapor_pressure

thermo = ThermodynamicConstants()

T = collect(200:0.1:320)
pᵛˡ⁺ = [saturation_vapor_pressure(Tⁱ, thermo, thermo.liquid) for Tⁱ in T]
pᵛⁱ⁺ = [saturation_vapor_pressure(Tⁱ, thermo, thermo.solid) for Tⁱ in T]
pᵛⁱ⁺[T .&gt; thermo.triple_point_temperature] .= NaN

using CairoMakie

fig = Figure()
ax = Axis(fig[1, 1], xlabel=&quot;Temperature (ᵒK)&quot;, ylabel=&quot;Saturation vapor pressure pᵛ⁺ (Pa)&quot;, yscale = log10, xticks=200:20:320)
lines!(ax, T, pᵛˡ⁺, label=&quot;vapor pressure over liquid&quot;)
lines!(ax, T, pᵛⁱ⁺, linestyle=:dash, label=&quot;vapor pressure over ice&quot;)
axislegend(ax, position=:rb)
fig</code></pre><img src="73aa84ee.svg" alt="Example block output"/><p>The saturation specific humidity is</p><p class="math-container">\[qᵛ⁺ ≡ \frac{ρᵛ⁺}{ρ} = \frac{pᵛ⁺}{ρ Rᵐ T} .\]</p><p>and this is what it looks like:</p><pre><code class="language-julia hljs">using Breeze
using Breeze.MoistAirBuoyancies: saturation_specific_humidity

thermo = ThermodynamicConstants()
ref = ReferenceStateConstants(base_pressure=101325, potential_temperature=288)

z = 0
T = collect(273.2:0.1:313.2)
qᵛ⁺ = [saturation_specific_humidity(Tⁱ, z, ref, thermo, thermo.liquid) for Tⁱ in T]

using CairoMakie

fig = Figure()
ax = Axis(fig[1, 1], xlabel=&quot;Temperature (ᵒK)&quot;, ylabel=&quot;Saturation specific humidity qᵛ⁺ (kg kg⁻¹)&quot;)
lines!(ax, T, qᵛ⁺)
fig</code></pre><img src="06345acb.svg" alt="Example block output"/><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><p>The conservation of energy states that any external heat input into the gas must equal the sum   of the change of the gas&#39;s internal energy and the work done by the gas, <span>$p \, \mathrm{d} V$</span>.   For atmospheric flows it&#39;s convenient to express everything per unit mass. Assuming the mass of   the fluid is conserved, we have that the work done per unit mass is <span>$p \, \mathrm{d}(\rho^{-1})$</span>   and the internal energy per unit mass is <span>$cᵛ \mathrm{d} T$</span>.   Therefore, if <span>$\mathrm{d} \mathcal{Q}$</span> is the external heat change per unit mass,   we have:</p><p class="math-container">\[\mathrm{d} \mathcal{Q} = cᵛ \mathrm{d}T + p \, \mathrm{d}(ρ^{-1}) .\]</p><p>By utilising the identity <span>$\mathrm{d}(p / ρ) = p \, \mathrm{d}(ρ^{-1}) + ρ^{-1} \mathrm{d}p$</span> and using   the ideal gas, we can rewrite the above conservation law as:</p><p class="math-container">\[\mathrm{d} \mathcal{Q} = (cᵛ + R) \mathrm{d}T - ρ^{-1} \mathrm{d}p ,\]</p><p>which is the expression in the main text after noting that the specific heat capacities under   constant pressure and under constant volume are related via <span>$cᵖ ≡ cᵛ + R$</span>.</p></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../microphysics/microphysics_overview/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 5 November 2025 04:29">Wednesday 5 November 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
