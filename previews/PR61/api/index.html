<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Breeze</title><meta name="title" content="API · Breeze"/><meta property="og:title" content="API · Breeze"/><meta property="twitter:title" content="API · Breeze"/><meta name="description" content="Documentation for Breeze."/><meta property="og:description" content="Documentation for Breeze."/><meta property="twitter:description" content="Documentation for Breeze."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Breeze</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../thermodynamics/">Thermodynamics</a></li><li><span class="tocitem">Microphysics</span><ul><li><a class="tocitem" href="../microphysics/microphysics_overview/">Overview</a></li><li><a class="tocitem" href="../microphysics/saturation_adjustment/">Warm phase saturation adjustment</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Public-API"><span>Public API</span></a></li><li><a class="tocitem" href="#Private-API"><span>Private API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Documentation"><a class="docs-heading-anchor" href="#API-Documentation">API Documentation</a><a id="API-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#API-Documentation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Breeze" href="#Breeze.Breeze"><code>Breeze.Breeze</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Julia package for finite volume GPU and CPU large eddy simulations (LES) of atmospheric flows. The abstractions, design, and finite volume engine are based on Oceananigans.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Breeze.jl#L1-L5">source</a></section></article><h2 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h2><h3 id="Thermodynamics"><a class="docs-heading-anchor" href="#Thermodynamics">Thermodynamics</a><a id="Thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamics" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Thermodynamics.AtmosphereThermodynamics" href="#Breeze.Thermodynamics.AtmosphereThermodynamics"><code>Breeze.Thermodynamics.AtmosphereThermodynamics</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AtmosphereThermodynamics(FT = Oceananigans.defaults.FloatType;
                         gravitational_acceleration = 9.81,
                         molar_gas_constant = 8.314462618,
                         energy_reference_temperature = 273.16,
                         triple_point_temperature = 273.16,
                         triple_point_pressure = 611.657,
                         dry_air_molar_mass = 0.02897,
                         dry_air_heat_capacity = 1005,
                         vapor_molar_mass = 0.018015,
                         vapor_heat_capacity = 1850,
                         liquid = liquid_water(FT),
                         solid = water_ice(FT),
                         condensed_phases = nothing)</code></pre><p>Create <code>AtmosphereThermodynamics</code> with parameters that represent gaseous mixture of dry &quot;air&quot; and vapor, as well as condensed liquid and solid phases. The <code>triple_point_temperature</code> and <code>triple_point_pressure</code> may be combined with internal energy parameters for condensed phases to compute the vapor pressure at the boundary between vapor and a homogeneous sample of the condensed phase. The <code>gravitational_acceleration</code> parameter is included to compute reference_state quantities associated with hydrostatic balance.</p><p>The Clausius-Clapeyron relation describes the pressure-temperature relationship during phase transitions:</p><p class="math-container">\[d[\log(pⁱ⁺)] / dT = ℒⁱ / (Rⁱ T²)\]</p><p>where:</p><ul><li><span>$pⁱ⁺$</span> is the saturation vapor pressure for a transition between vapor and the <span>$i$</span>-th phase</li><li><span>$T$</span> is temperature</li><li><span>$ℒⁱ$</span> is the latent heat of vaporization</li><li><span>$Rⁱ$</span> is the specific gas constant for the <span>$i$</span>-th phase</li></ul><p>For water vapor, this integrates to:</p><p class="math-container">\[pⁱ⁺ = pᵗʳ \exp[ ℒⁱ (1/Tᵗʳ - 1/T) / Rⁱ ]\]</p><p>where</p><ul><li><span>$pᵗʳ$</span> is the triple point pressure</li><li><span>$Tᵗʳ$</span> is the triple point temperature</li></ul><p>and it is calculated via <a href="#Breeze.Thermodynamics.saturation_vapor_pressure-Tuple{Any, Any, CondensedPhase}"><code>saturation_vapor_pressure</code></a>.</p><p>Note: any reference values for pressure and temperature can be used in principle. The advantage of using reference values at the triple point is that the same values can then be used for both condensation (vapor → liquid) and deposition (vapor → ice).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Thermodynamics/atmosphere_thermodynamics.jl#L147-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Thermodynamics.CondensedPhase" href="#Breeze.Thermodynamics.CondensedPhase"><code>Breeze.Thermodynamics.CondensedPhase</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CondensedPhase(FT = Oceananigans.defaults.FloatType; latent_heat, heat_capacity)</code></pre><p>Returns <code>CondensedPhase</code> with specified parameters converted to <code>FT</code>.</p><p>Two examples of <code>CondensedPhase</code> are liquid and solid. When matter is converted from vapor to liquid, water molecules in the gas phase cluster together and slow down to form liquid with <code>heat_capacity</code>, The lost of molecular kinetic energy is called the <code>latent_heat</code>.</p><p>Likewise, during deposition, water molecules in the gas phase cluster into ice crystals.</p><p><strong>Arguments</strong></p><ul><li><code>FT</code>: Float type to use (defaults to Oceananigans.defaults.FloatType)</li><li><code>latent_heat</code>: Difference between the internal energy of the gaseous phase at the <code>energy_reference_temperature</code>.</li><li><code>heat_capacity</code>: Heat capacity of the phase of matter.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Thermodynamics/atmosphere_thermodynamics.jl#L67-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Thermodynamics.IdealGas" href="#Breeze.Thermodynamics.IdealGas"><code>Breeze.Thermodynamics.IdealGas</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IdealGas{FT}</code></pre><p>A struct representing an ideal gas with molar mass and specific heat capacity.</p><p><strong>Fields</strong></p><ul><li><code>molar_mass</code>: Molar mass of the gas in kg/mol</li><li><code>heat_capacity</code>: Specific heat capacity at constant pressure in J/(kg·K)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">dry_air = IdealGas(molar_mass=0.02897, heat_capacity=1005)

# output
&quot;IdealGas{Float64}(molar_mass=0.02897, heat_capacity=1005)&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Thermodynamics/atmosphere_thermodynamics.jl#L4-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Thermodynamics.mixture_gas_constant-Tuple{Any, AtmosphereThermodynamics}" href="#Breeze.Thermodynamics.mixture_gas_constant-Tuple{Any, AtmosphereThermodynamics}"><code>Breeze.Thermodynamics.mixture_gas_constant</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mixture_gas_constant(q, thermo)</code></pre><p>Compute the gas constant of moist air given the specific humidity <code>q</code> and thermodynamic parameters <code>thermo</code>.</p><p>The mixture gas constant is calculated as a weighted average of the dry air and water vapor gas constants:</p><p class="math-container">\[R_m = R_d (1 - q) + R_v q\]</p><p>where:</p><ul><li><code>R_d</code> is the dry air gas constant</li><li><code>R_v</code> is the water vapor gas constant</li><li><code>q</code> is the specific humidity (mass fraction of water vapor)</li></ul><p><strong>Arguments</strong></p><ul><li><code>q</code>: Specific humidity (dimensionless)</li><li><code>thermo</code>: <code>AtmosphereThermodynamics</code> instance containing gas constants</li></ul><p><strong>Returns</strong></p><ul><li>Gas constant of the moist air mixture in J/(kg·K)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Thermodynamics/atmosphere_thermodynamics.jl#L239-L263">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Thermodynamics.mixture_heat_capacity-Tuple{Any, AtmosphereThermodynamics}" href="#Breeze.Thermodynamics.mixture_heat_capacity-Tuple{Any, AtmosphereThermodynamics}"><code>Breeze.Thermodynamics.mixture_heat_capacity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mixture_heat_capacity(q, thermo)</code></pre><p>Compute the heat capacity of state air given the total specific humidity q and assuming that condensate mass ratio qᶜ ≪ q, where qℓ is the mass ratio of liquid condensate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Thermodynamics/atmosphere_thermodynamics.jl#L270-L276">source</a></section></article><h3 id="MoistAirBuoyancies"><a class="docs-heading-anchor" href="#MoistAirBuoyancies">MoistAirBuoyancies</a><a id="MoistAirBuoyancies-1"></a><a class="docs-heading-anchor-permalink" href="#MoistAirBuoyancies" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.MoistAirBuoyancies.MoistAirBuoyancy" href="#Breeze.MoistAirBuoyancies.MoistAirBuoyancy"><code>Breeze.MoistAirBuoyancies.MoistAirBuoyancy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MoistAirBuoyancy(FT=Oceananigans.defaults.FloatType;
                 thermodynamics = AtmosphereThermodynamics(FT),
                 reference_constants = ReferenceStateConstants{FT}(101325, 290))</code></pre><p>Return a MoistAirBuoyancy formulation that can be provided as input to an <code>AtmosphereModel</code> or an <code>Oceananigans.NonhydrostaticModel</code>.</p><div class="admonition is-info" id="Required-tracers-e794f4173724a9da"><header class="admonition-header">Required tracers<a class="admonition-anchor" href="#Required-tracers-e794f4173724a9da" title="Permalink"></a></header><div class="admonition-body"><p><code>MoistAirBuoyancy</code> requires tracers <code>q</code> and <code>θ</code> to be included in the model.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Breeze, Oceananigans

julia&gt; buoyancy = MoistAirBuoyancy()
MoistAirBuoyancy
├── reference_constants: Breeze.Thermodynamics.ReferenceStateConstants{Float64}
└── thermodynamics: AtmosphereThermodynamics

julia&gt; model = NonhydrostaticModel(; grid = RectilinearGrid(size=(8, 8, 8), extent=(1, 2, 3)),
                                     buoyancy, tracers = (:θ, :q))
NonhydrostaticModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── grid: 8×8×8 RectilinearGrid{Float64, Periodic, Periodic, Bounded} on CPU with 3×3×3 halo
├── timestepper: RungeKutta3TimeStepper
├── advection scheme: Centered(order=2)
├── tracers: (θ, q)
├── closure: Nothing
├── buoyancy: MoistAirBuoyancy with ĝ = NegativeZDirection()
└── coriolis: Nothing</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/MoistAirBuoyancies.jl#L39-L72">source</a></section></article><h3 id="AtmosphereModels"><a class="docs-heading-anchor" href="#AtmosphereModels">AtmosphereModels</a><a id="AtmosphereModels-1"></a><a class="docs-heading-anchor-permalink" href="#AtmosphereModels" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.AtmosphereModels.AtmosphereModel-Tuple{Any}" href="#Breeze.AtmosphereModels.AtmosphereModel-Tuple{Any}"><code>Breeze.AtmosphereModels.AtmosphereModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AtmosphereModel(grid;
                clock = Clock(grid),
                thermodynamics = AtmosphereThermodynamics(eltype(grid)),
                formulation = default_formulation(grid, thermodynamics),
                absolute_humidity = DefaultValue(),
                tracers = tuple(),
                coriolis = nothing,
                boundary_conditions = NamedTuple(),
                forcing = NamedTuple(),
                advection = WENO(order=5),
                microphysics = WarmPhaseSaturationAdjustment(),
                timestepper = :RungeKutta3)</code></pre><p>Return an AtmosphereModel that uses the anelastic approximation following <a href="../references/#Pauluis2008">Pauluis (2008)</a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Breeze, Breeze.AtmosphereModels, Oceananigans

julia&gt; grid = RectilinearGrid(size=(8, 8, 8), extent=(1, 2, 3));

julia&gt; model = AtmosphereModel(grid)
AtmosphereModel{CPU, RectilinearGrid}(time = 0 seconds, iteration = 0)
├── grid: 8×8×8 RectilinearGrid{Float64, Periodic, Periodic, Bounded} on CPU with 3×3×3 halo
├── formulation: AnelasticFormulation(p₀=101325.0, θᵣ=288.0)
├── timestepper: RungeKutta3TimeStepper
├── advection scheme: WENO{3, Float64, Float32}(order=5)
├── tracers: ()
├── coriolis: Nothing
└── microphysics: WarmPhaseSaturationAdjustment</code></pre><p><strong>References</strong></p><p>Pauluis, O. (2008). Thermodynamic consistency of the anelastic approximation for a moist atmosphere.   Journal of the Atmospheric Sciences 65, 2719–2729.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/AtmosphereModels/atmosphere_model.jl#L69-L109">source</a></section></article><h2 id="Private-API"><a class="docs-heading-anchor" href="#Private-API">Private API</a><a id="Private-API-1"></a><a class="docs-heading-anchor-permalink" href="#Private-API" title="Permalink"></a></h2><h3 id="Thermodynamics-2"><a class="docs-heading-anchor" href="#Thermodynamics-2">Thermodynamics</a><a class="docs-heading-anchor-permalink" href="#Thermodynamics-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Thermodynamics.reference_density-Tuple{Any, Any, Any}" href="#Breeze.Thermodynamics.reference_density-Tuple{Any, Any, Any}"><code>Breeze.Thermodynamics.reference_density</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_density(z, ref, thermo)</code></pre><p>Compute the reference density associated with the reference pressure and potential temperature. The reference density is defined as the density of dry air at the reference pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Thermodynamics/atmosphere_thermodynamics.jl#L311-L316">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Thermodynamics.reference_density-Tuple{Any, ReferenceStateConstants, Any}" href="#Breeze.Thermodynamics.reference_density-Tuple{Any, ReferenceStateConstants, Any}"><code>Breeze.Thermodynamics.reference_density</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_density(z, ref::ReferenceStateConstants, thermo)</code></pre><p>Compute the reference density at height <code>z</code> that associated with the reference pressure and potential temperature. The reference density is defined as the density of dry air at the reference pressure and temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Thermodynamics/reference_states.jl#L20-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Thermodynamics.saturation_specific_humidity-Tuple{Any, Any, Any, CondensedPhase}" href="#Breeze.Thermodynamics.saturation_specific_humidity-Tuple{Any, Any, Any, CondensedPhase}"><code>Breeze.Thermodynamics.saturation_specific_humidity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">saturation_specific_humidity(T, ρ, thermo, condensed_phase::CondensedPhase)</code></pre><p>Compute the saturation specific humidity for a gas at temperature <code>T</code>, total density <code>ρ</code>, <code>thermo</code>dynamics, and <code>condensed_phase</code> via:</p><p class="math-container">\[qᵛ⁺ = pᵛ⁺ / (ρ Rᵛ T) ,\]</p><p>where <span>$pᵛ⁺$</span> is the <a href="#Breeze.Thermodynamics.saturation_vapor_pressure-Tuple{Any, Any, CondensedPhase}"><code>saturation_vapor_pressure</code></a>, and <span>$Rᵛ$</span> is the specific gas constant for water vapor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Thermodynamics/vapor_saturation.jl#L38-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.Thermodynamics.saturation_vapor_pressure-Tuple{Any, Any, CondensedPhase}" href="#Breeze.Thermodynamics.saturation_vapor_pressure-Tuple{Any, Any, CondensedPhase}"><code>Breeze.Thermodynamics.saturation_vapor_pressure</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">saturation_vapor_pressure(T, thermo, phase::CondensedPhase)</code></pre><p>Compute the saturation vapor pressure <span>$pᵛ⁺$</span> over a fluid surface at <code>phase</code> (i.e., liquid or solid) from the Clausius-Clapeyron relation,</p><p class="math-container">\[dpᵛ⁺ / dT = pᵛ⁺ ℒᵛ(T) / (Rᵛ T^2) ,\]</p><p>where <span>$ℒᵛ(T) = ℒᵛ(T=0) + Δcᵖ T$</span>, with <span>$Δcᵖ ≡ (cᵖᵛ - cᵖˡ)$</span> .</p><p>The saturation vapor pressure <span>$pᵛ⁺$</span> is obtained after integrating the above from the triple point, i.e., <span>$p(Tᵗʳ) = pᵗʳ$</span> to get</p><p class="math-container">\[pᵛ⁺(T) = pᵗʳ \left ( \frac{T}{Tᵗʳ} \right )^{Δcᵖ / Rᵛ} \exp \left [ (1/Tᵗʳ - 1/T) ℒᵛ(T=0) / Rᵛ \right ] .\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/Thermodynamics/vapor_saturation.jl#L1-L19">source</a></section></article><h3 id="MoistAirBuoyancies-2"><a class="docs-heading-anchor" href="#MoistAirBuoyancies-2">MoistAirBuoyancies</a><a class="docs-heading-anchor-permalink" href="#MoistAirBuoyancies-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.MoistAirBuoyancies.temperature-Union{Tuple{FT}, Tuple{Breeze.MoistAirBuoyancies.HeightReferenceThermodynamicState{FT}, Any, Any}} where FT" href="#Breeze.MoistAirBuoyancies.temperature-Union{Tuple{FT}, Tuple{Breeze.MoistAirBuoyancies.HeightReferenceThermodynamicState{FT}, Any, Any}} where FT"><code>Breeze.MoistAirBuoyancies.temperature</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">temperature(state::HeightReferenceThermodynamicState, ref, thermo)</code></pre><p>Return the temperature <span>$T$</span> that satisfies saturation adjustment, that is, the temperature for which</p><p class="math-container">\[θ = [1 - ℒ qˡ / (cᵖᵐ T)] T / Π ,\]</p><p>with <span>$qˡ = \max(0, qᵗ - qᵛ⁺)$</span> the condensate specific humidity, where <span>$qᵗ$</span> is the total specific humidity, <span>$qᵛ⁺$</span> is the saturation specific humidity.</p><p>The saturation adjustment temperature is obtained by solving <span>$r(T)$</span>, where</p><p class="math-container">\[r(T) ≡ T - θ Π - ℒ qˡ / (cᵖᵐ T) .\]</p><p>Solution of <span>$r(T) = 0$</span> is found via the <a href="https://en.wikipedia.org/wiki/Secant_method">secant method</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/MoistAirBuoyancies.jl#L246-L265">source</a></section></article><h3 id="AtmosphereModels-2"><a class="docs-heading-anchor" href="#AtmosphereModels-2">AtmosphereModels</a><a class="docs-heading-anchor-permalink" href="#AtmosphereModels-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Breeze.AtmosphereModels._pressure_correct_momentum!-Tuple{Any}" href="#Breeze.AtmosphereModels._pressure_correct_momentum!-Tuple{Any}"><code>Breeze.AtmosphereModels._pressure_correct_momentum!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Update the predictor momentum (ρu, ρv, ρw) with the non-hydrostatic pressure via</p><pre><code class="nohighlight hljs">u^{n+1} = u^n - δₓp_{NH} / Δx * Δt</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/AtmosphereModels/anelastic_formulation.jl#L255-L259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Oceananigans.TimeSteppers.compute_flux_bc_tendencies!-Tuple{AtmosphereModel}" href="#Oceananigans.TimeSteppers.compute_flux_bc_tendencies!-Tuple{AtmosphereModel}"><code>Oceananigans.TimeSteppers.compute_flux_bc_tendencies!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Apply boundary conditions by adding flux divergences to the right-hand-side. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalEarth/Breeze.jl/blob/b6de9b574e058d1634e00b4d2db0263c81cfea20/src/AtmosphereModels/update_atmosphere_model_state.jl#L263">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../references/">« References</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Monday 3 November 2025 11:14">Monday 3 November 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
