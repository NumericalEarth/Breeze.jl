<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Thermodynamics ¬∑ Breeze</title><meta name="title" content="Thermodynamics ¬∑ Breeze"/><meta property="og:title" content="Thermodynamics ¬∑ Breeze"/><meta property="twitter:title" content="Thermodynamics ¬∑ Breeze"/><meta name="description" content="Documentation for Breeze."/><meta property="og:description" content="Documentation for Breeze."/><meta property="twitter:description" content="Documentation for Breeze."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Breeze</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Thermodynamics</a><ul class="internal"><li><a class="tocitem" href="#Two-laws-for-ideal-gases"><span>Two laws for ideal gases</span></a></li><li><a class="tocitem" href="#An-example-of-a-dry-reference-state-in-Breeze"><span>An example of a dry reference state in Breeze</span></a></li><li><a class="tocitem" href="#Thermodynamic-relations-for-gaseous-mixtures"><span>Thermodynamic relations for gaseous mixtures</span></a></li><li><a class="tocitem" href="#Liquid-ice-potential-temperature"><span>Liquid-ice potential temperature</span></a></li><li><a class="tocitem" href="#The-Clausius‚ÄìClapeyron-relation-and-saturation-specific-humidity"><span>The Clausius‚ÄìClapeyron relation and saturation specific humidity</span></a></li></ul></li><li><span class="tocitem">Microphysics</span><ul><li><a class="tocitem" href="../microphysics/microphysics_overview/">Overview</a></li><li><a class="tocitem" href="../microphysics/saturation_adjustment/">Warm phase saturation adjustment</a></li></ul></li><li><a class="tocitem" href="../dynamics/">Dycore equations and algorithms</a></li><li><span class="tocitem">Appendix</span><ul><li><a class="tocitem" href="../appendix/notation/">Notation</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Thermodynamics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Thermodynamics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalEarth/Breeze.jl/blob/main/docs/src/thermodynamics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Atmosphere-Thermodynamics"><a class="docs-heading-anchor" href="#Atmosphere-Thermodynamics">Atmosphere Thermodynamics</a><a id="Atmosphere-Thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Atmosphere-Thermodynamics" title="Permalink"></a></h1><p>Breeze implements thermodynamic relations for moist atmospheres. By &quot;moist&quot;, we mean that the atmosphere is a binary mixture of <em>(i)</em> &quot;dry&quot; air, and <em>(ii)</em> &quot;vapor&quot;. The presence of moisture makes life interesting, because vapor can <em>condense</em> or <em>solidify</em> (and liquid can <em>freeze</em>) into droplets and particles of so many shapes and sizes.</p><p>On Earth, dry air is itself a mixture of gases, the vapor component is <span>$\mathrm{H_2 O}$</span>, also known as &quot;water&quot;. Liquid droplets, which include almost-suspended tiny droplets as well as big raindrops, and ice particles such as snow, graupel, and hail, are called &quot;condensates&quot;. Breeze models dry air as having a fixed composition with constant <a href="https://en.wikipedia.org/wiki/Molar_mass">molar mass</a>. Dry air on Earth&#39;s is mostly nitrogen, oxygen, and argon, whose combination produces the typical (and Breeze&#39;s default) dry air molar mass</p><pre><code class="language-julia hljs">using Breeze
thermo = ThermodynamicConstants()
thermo.dry_air.molar_mass</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.02897</code></pre><p>Water vapor, which in Breeze has the default molar mass</p><pre><code class="language-julia hljs">thermo.vapor.molar_mass</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.018015</code></pre><p>is lighter than dry air. As a result, moist, humid air is <em>lighter</em> than dry air.</p><h2 id="Two-laws-for-ideal-gases"><a class="docs-heading-anchor" href="#Two-laws-for-ideal-gases">Two laws for ideal gases</a><a id="Two-laws-for-ideal-gases-1"></a><a class="docs-heading-anchor-permalink" href="#Two-laws-for-ideal-gases" title="Permalink"></a></h2><p>Both dry air and vapor are modeled as ideal gases, which means that the <a href="https://en.wikipedia.org/wiki/Ideal_gas_law">ideal gas law</a> relates pressure <span>$p$</span>, temperature <span>$T$</span>, and density <span>$œÅ$</span>,</p><p class="math-container">\[p = œÅ R T .\]</p><p>Above, <span>$R ‚â° ‚Ñõ / m$</span> is the specific gas constant given the <a href="https://en.wikipedia.org/wiki/Gas_constant">molar or &quot;universal&quot; gas constant</a> <span>$‚Ñõ ‚âà 8.31 \; \mathrm{J} \, \mathrm{K}^{-1} \, \mathrm{mol}^{-1}$</span> and molar mass <span>$m$</span> of the gas species under consideration.</p><p>The <a href="https://en.wikipedia.org/wiki/First_law_of_thermodynamics">first law of thermodynamics</a>, aka &quot;conservation of energy&quot;, states that infinitesimal changes in &quot;heat content&quot;<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> <span>$\mathrm{d} \mathcal{H}$</span> are related to infinitesimal changes in temperature <span>$\mathrm{d} T$</span> and pressure <span>$\mathrm{d} p$</span> according to:<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p><p class="math-container">\[\mathrm{d} \mathcal{H} = c·µñ \mathrm{d} T - \frac{\mathrm{d} p}{œÅ} ,\]</p><p>where <span>$c·µñ$</span> is the specific heat capacity at constant pressure of the gas in question.</p><p>For example, to represent dry air typical for Earth, with molar mass <span>$m = 0.029 \; \mathrm{kg} \, \mathrm{mol}^{-1}$</span> and constant-pressure heat capacity <span>$c^p = 1005 \; \mathrm{J} \, \mathrm{kg}^{-1} \, \mathrm{K}^{-1}$</span>, we write</p><pre><code class="language-julia hljs">using Breeze.Thermodynamics: IdealGas
dry_air = IdealGas(molar_mass=0.029, heat_capacity=1005)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">IdealGas{Float64}(molar_mass=0.029, heat_capacity=1005.0)</code></pre><p>We can also change the properties of dry air by specifying new values when constructing <code>ThermodynamicConstants</code>,</p><pre><code class="language-julia hljs">weird_thermo = ThermodynamicConstants(dry_air_molar_mass=0.042, dry_air_heat_capacity=420)
weird_thermo.dry_air</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">IdealGas{Float64}(molar_mass=0.042, heat_capacity=420.0)</code></pre><h3 id="Potential-temperature-and-&quot;adiabatic&quot;-transformations"><a class="docs-heading-anchor" href="#Potential-temperature-and-&quot;adiabatic&quot;-transformations">Potential temperature and &quot;adiabatic&quot; transformations</a><a id="Potential-temperature-and-&quot;adiabatic&quot;-transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-temperature-and-&quot;adiabatic&quot;-transformations" title="Permalink"></a></h3><p>Within adiabatic transformations, <span>$\mathrm{d} \mathcal{H} = 0$</span>. Then, combining the ideal gas law with conservation of energy yields</p><p class="math-container">\[\frac{\mathrm{d} T}{T} = \frac{R}{c·µñ} \frac{\mathrm{d} p}{p} ,\]</p><p>which implies that <span>$T ‚àº ( p / p‚ÇÄ )^{R / c·µñ}$</span>, where <span>$p‚ÇÄ$</span> is some reference pressure value.</p><p>As a result, the <em>potential temperature</em>, <span>$Œ∏$</span>, defined as</p><p class="math-container">\[Œ∏ ‚â° T \big / \left ( \frac{p}{p‚ÇÄ} \right )^{R / c·µñ} = \frac{T}{Œ†} ,\]</p><p>remains constant under adiabatic transformations. Notice that above, we also defined the Exner function, <span>$Œ† ‚â° ( p / p‚ÇÄ )^{R / c·µñ}$</span>.</p><div class="admonition is-info" id="About-subscripts-876bafcfa77f1c6a"><header class="admonition-header">About subscripts<a class="admonition-anchor" href="#About-subscripts-876bafcfa77f1c6a" title="Permalink"></a></header><div class="admonition-body"><p>The subscript &quot;0&quot; typically indicates some quantity evaluated at the surface <span>$z=0$</span>. By convention, we tend to invoke constants that represent profiles evaluated at <span>$z=0$</span>: i.e., <span>$p‚ÇÄ = p(z=0)$</span>, <span>$T‚ÇÄ = T(z=0)$</span>, etc. This implies that the potential temperature under adiabatic transformation is <span>$Œ∏(z) = Œ∏‚ÇÄ = T‚ÇÄ$</span>.</p></div></div><h3 id="Hydrostatic-balance"><a class="docs-heading-anchor" href="#Hydrostatic-balance">Hydrostatic balance</a><a id="Hydrostatic-balance-1"></a><a class="docs-heading-anchor-permalink" href="#Hydrostatic-balance" title="Permalink"></a></h3><p>Next we consider a reference state that does not exchange energy with its environment (i.e., <span>$\mathrm{d} \mathcal{H} = 0$</span>) and thus has constant potential temperature</p><p class="math-container">\[Œ∏‚ÇÄ = T·µ£ \left ( \frac{p‚ÇÄ}{p·µ£} \right )^{R / c·µñ} .\]</p><div class="admonition is-info" id="Reference-states-d2d06eba54fb75e2"><header class="admonition-header">Reference states<a class="admonition-anchor" href="#Reference-states-d2d06eba54fb75e2" title="Permalink"></a></header><div class="admonition-body"><p>Subscripts <span>$r$</span> indicate a <em>reference</em> state. The adiabatic, hydrostatically-balanced reference state in the process of elucidation presently has a <span>$z$</span> dependent reference pressure <span>$p·µ£(z)$</span>, density <span>$œÅ·µ£(z)$</span>, and temperature <span>$T·µ£(z)$</span>. This reference state also has a <em>constant</em> potential temperature <span>$Œ∏·µ£$</span>, which we attempt to clarify by writing <span>$Œ∏‚ÇÄ$</span> (since it&#39;s constant, it has the same value at <span>$z=0$</span> as at any height). We apologize that our notation differs from the usual in which <span>$0$</span> subscripts indicate &quot;reference&quot; (ü§î) and <span>$00$</span> (ü´£) means <span>$z=0$</span>.</p></div></div><p>Hydrostatic balance requires</p><p class="math-container">\[‚àÇ_z p·µ£ = - œÅ·µ£ g ,\]</p><p>where <span>$g$</span> is gravitational acceleration, naturally by default</p><pre><code class="language-julia hljs">thermo.gravitational_acceleration</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">9.81</code></pre><p>By combining the hydrostatic balance with the ideal gas law and the definition of potential temperature we get</p><p class="math-container">\[\frac{p·µ£}{p‚ÇÄ} = \left (1 - \frac{g z}{c·µñ Œ∏‚ÇÄ} \right )^{c·µñ / R} .\]</p><p>Thus</p><p class="math-container">\[T·µ£(z) = Œ∏‚ÇÄ \left ( \frac{p·µ£}{p‚ÇÄ} \right )^{R / c·µñ} = Œ∏‚ÇÄ \left ( 1 - \frac{g z}{c·µñ Œ∏‚ÇÄ} \right ) ,\]</p><p>and</p><p class="math-container">\[œÅ·µ£(z) = \frac{p‚ÇÄ}{R·µà Œ∏‚ÇÄ} \left ( 1 - \frac{g z}{c·µñ Œ∏‚ÇÄ} \right )^{c·µñ / R - 1} .\]</p><h2 id="An-example-of-a-dry-reference-state-in-Breeze"><a class="docs-heading-anchor" href="#An-example-of-a-dry-reference-state-in-Breeze">An example of a dry reference state in Breeze</a><a id="An-example-of-a-dry-reference-state-in-Breeze-1"></a><a class="docs-heading-anchor-permalink" href="#An-example-of-a-dry-reference-state-in-Breeze" title="Permalink"></a></h2><p>We can visualise a hydrostatic reference profile evaluating Breeze&#39;s reference-state utilities (which assume a dry reference state) on a one-dimensional <code>RectilinearGrid</code>. In the following code, the superscript <span>$d$</span> denotes dry air, e.g., an ideal gas with <span>$R·µà = 286.71 \; \mathrm{J} \, \mathrm{K}^{-1}$</span>:</p><pre><code class="language-julia hljs">using Breeze
using Breeze.Thermodynamics: reference_pressure, reference_density
using CairoMakie

thermo = ThermodynamicConstants()
constants = ReferenceStateConstants(base_pressure=101325, potential_temperature=288)
grid = RectilinearGrid(size=160, z=(0, 12_000), topology=(Flat, Flat, Bounded))

p·µ£ = CenterField(grid)
œÅ·µ£ = CenterField(grid)

set!(p·µ£, z -&gt; reference_pressure(z, constants, thermo))
set!(œÅ·µ£, z -&gt; reference_density(z, constants, thermo))

R·µà = Breeze.Thermodynamics.dry_air_gas_constant(thermo)
c·µñ·µà = thermo.dry_air.heat_capacity
p‚ÇÄ = constants.base_pressure
Œ∏‚ÇÄ = constants.reference_potential_temperature
g = thermo.gravitational_acceleration

# Verify that T·µ£ = Œ∏‚ÇÄ (1 - g z / (c·µñ·µà Œ∏‚ÇÄ))
z = KernelFunctionOperation{Center, Center, Center}(znode, grid, Center(), Center(), Center())
T·µ£‚ÇÅ = Field(Œ∏‚ÇÄ * (p·µ£ / p‚ÇÄ)^(R·µà / c·µñ·µà))
T·µ£‚ÇÇ = Field(Œ∏‚ÇÄ * (1 - g * z / (c·µñ·µà * Œ∏‚ÇÄ)))

fig = Figure()

axT = Axis(fig[1, 1]; xlabel = &quot;Temperature (·µíK)&quot;, ylabel = &quot;Height (m)&quot;)
lines!(axT, T·µ£‚ÇÅ)
lines!(axT, T·µ£‚ÇÇ, linestyle = :dash, color = :orange, linewidth = 2)

axp = Axis(fig[1, 2]; xlabel = &quot;Pressure (10‚Åµ Pa)&quot;, yticklabelsvisible = false)
lines!(axp, p·µ£ / 1e5)

axœÅ = Axis(fig[1, 3]; xlabel = &quot;Density (kg m‚Åª¬≥)&quot;, yticklabelsvisible = false)
lines!(axœÅ, œÅ·µ£)

fig</code></pre><img src="f1e56f04.svg" alt="Example block output"/><h2 id="Thermodynamic-relations-for-gaseous-mixtures"><a class="docs-heading-anchor" href="#Thermodynamic-relations-for-gaseous-mixtures">Thermodynamic relations for gaseous mixtures</a><a id="Thermodynamic-relations-for-gaseous-mixtures-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamic-relations-for-gaseous-mixtures" title="Permalink"></a></h2><p>&quot;Moist air&quot; is conceived to be a mixture of two gas phases: &quot;dry air&quot; (itself a mixture of gases) and water vapor, as well as a collection of liquid droplet and solid ice particle &quot;condensates&quot;. We assume that the volume of the condensates is negligible, such that the total pressure is the sum of partial pressures of vapor and dry air,</p><p class="math-container">\[p = p·µà + p·µõ .\]</p><p>(Superscripts <span>$d$</span> and <span>$v$</span> denote dry air and vapor respectively.)</p><p>The partial pressure of the dry air and vapor components are related to the component densities <span>$œÅ·µà$</span> and <span>$œÅ·µõ$</span> through the ideal gas law,</p><p class="math-container">\[p·µà = œÅ·µà R·µà T \qquad \text{and} \qquad p·µõ = œÅ·µõ R·µõ T ,\]</p><p>where <span>$T$</span> is temperature, <span>$R‚Å± = ‚Ñõ / m^Œ≤$</span> is the specific gas constant for component <span>$Œ≤$</span>, <span>$‚Ñõ$</span>  is the <a href="https://en.wikipedia.org/wiki/Gas_constant">molar or &quot;universal&quot; gas constant</a>, and <span>$m^Œ≤$</span> is the molar mass of component <span>$Œ≤$</span>.</p><p>Central to Breeze&#39;s implementation of moist thermodynamics is a struct that holds parameters like the molar gas constant and molar masses,</p><pre><code class="language-julia hljs">thermo = ThermodynamicConstants()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ThermodynamicConstants{Float64}:
‚îú‚îÄ‚îÄ molar_gas_constant: 8.314462618
‚îú‚îÄ‚îÄ gravitational_acceleration: 9.81
‚îú‚îÄ‚îÄ energy_reference_temperature: 273.16
‚îú‚îÄ‚îÄ triple_point_temperature: 273.16
‚îú‚îÄ‚îÄ triple_point_pressure: 611.657
‚îú‚îÄ‚îÄ dry_air: IdealGas{Float64}(molar_mass=0.02897, heat_capacity=1005.0)
‚îú‚îÄ‚îÄ vapor: IdealGas{Float64}(molar_mass=0.018015, heat_capacity=1850.0)
‚îú‚îÄ‚îÄ liquid: CondensedPhase{Float64}(latent_heat=2.5008e6, heat_capacity=4181.0)
‚îî‚îÄ‚îÄ solid: CondensedPhase{Float64}(latent_heat=2.834e6, heat_capacity=2108.0)</code></pre><p>The default parameter evince basic facts about water vapor air typical to Earth&#39;s atmosphere: for example, the molar masses of dry air (itself a mixture of mostly nitrogen, oxygen, and argon), and water vapor are <span>$m·µà = 0.029 \; \mathrm{kg} \, \mathrm{mol}^{-1}$</span> and <span>$m·µõ = 0.018 \; \mathrm{kg} \, \mathrm{mol}^{-1}$</span>.</p><p>To write the effective gas law for moist air, we introduce the mass ratios, e.g., specific humidity and specific hydrometeor contents,</p><p class="math-container">\[q·µà ‚â° \frac{œÅ·µà}{œÅ} \qquad \text{and} \qquad q·µõ ‚â° \frac{œÅ·µõ}{œÅ} ,\]</p><p>where <span>$œÅ$</span> is total density of the fluid including dry air, vapor, and condensates, <span>$œÅ·µà$</span> is the density of dry air, and <span>$œÅ·µõ$</span> is the density of vapor. It&#39;s then convenient to introduce the &quot;mixture&quot; gas constant <span>$R·µê(q·µõ)$</span> such that</p><p class="math-container">\[p = œÅ R·µê T, \qquad \text{where} \qquad R·µê ‚â° q·µà R·µà + q·µõ R·µõ .\]</p><p>In &quot;clear&quot; (not cloudy) air, we have that <span>$q·µà = 1 - q·µõ$</span>. More generally, <span>$q·µà = 1 - q·µõ - q·∂ú$</span>, where <span>$q·∂ú$</span> is the total mass ratio of condensed species. In most situations on Earth, <span>$q·∂ú ‚â™ q·µõ$</span>.</p><pre><code class="language-julia hljs"># Compute mixture properties for air with 0.01 specific humidity
q·µõ = 0.01 # 1% water vapor by mass
R·µê = mixture_gas_constant(q·µõ, thermo)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">288.7477814111527</code></pre><p>We likewise define a mixture heat capacity via <span>$c·µñ·µê = q·µà c·µñ·µà + q·µõ c·µñ·µõ$</span>,</p><pre><code class="language-julia hljs">q = 0.01 # 1% water vapor by mass
c·µñ·µê = mixture_heat_capacity(q·µõ, thermo)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1013.45</code></pre><h2 id="Liquid-ice-potential-temperature"><a class="docs-heading-anchor" href="#Liquid-ice-potential-temperature">Liquid-ice potential temperature</a><a id="Liquid-ice-potential-temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Liquid-ice-potential-temperature" title="Permalink"></a></h2><h2 id="The-Clausius‚ÄìClapeyron-relation-and-saturation-specific-humidity"><a class="docs-heading-anchor" href="#The-Clausius‚ÄìClapeyron-relation-and-saturation-specific-humidity">The Clausius‚ÄìClapeyron relation and saturation specific humidity</a><a id="The-Clausius‚ÄìClapeyron-relation-and-saturation-specific-humidity-1"></a><a class="docs-heading-anchor-permalink" href="#The-Clausius‚ÄìClapeyron-relation-and-saturation-specific-humidity" title="Permalink"></a></h2><p>The <a href="https://en.wikipedia.org/wiki/Clausius%E2%80%93Clapeyron_relation">Clausius‚ÄìClapeyron relation</a> for an ideal gas</p><p class="math-container">\[\frac{\mathrm{d} p·µõ‚Å∫}{\mathrm{d} T} = \frac{p·µõ‚Å∫ ‚Ñí^Œ≤(T)}{R·µõ T^2} ,\]</p><p>where <span>$p·µõ‚Å∫$</span> is saturation vapor pressure, <span>$T$</span> is temperature, <span>$R·µõ$</span> is the specific gas constant for vapor, <span>$‚Ñí^Œ≤(T)$</span> is the latent heat of the transition from vapor to the <span>$Œ≤$</span> phase (e.g., <span>$Œ≤ = l$</span> for vapor ‚Üí liquid and <span>$Œ≤ = i$</span> for vapor to ice).</p><p>For a thermodynamic formulation that uses constant (i.e. temperature-independent) specific heats, the latent heat of a phase transition is linear in temperature. For example, for phase change from vapor to liquid,</p><p class="math-container">\[‚ÑíÀ°(T) = ‚ÑíÀ°(T=0) + \big ( \underbrace{c·µñ·µõ - c·µñÀ°}_{‚â°ŒîcÀ°} \big ) T ,\]</p><p>where <span>$‚ÑíÀ°(T=0)$</span> is the latent heat at absolute zero, <span>$T = 0 \; \mathrm{K}$</span>. By integrating from the triple-point temperature <span>$T·µó ≥$</span> for which <span>$p(T·µó ≥) = p·µó ≥$</span>, we get</p><p class="math-container">\[p·µõ‚Å∫(T) = p·µó ≥ \left ( \frac{T}{T·µó ≥} \right )^{ŒîcÀ° / R·µõ} \exp \left [ \frac{‚ÑíÀ°(T=0)}{R·µõ} \left (\frac{1}{T·µó ≥} - \frac{1}{T} \right ) \right ] .\]</p><p>Consider parameters for liquid water,</p><pre><code class="language-julia hljs">using Breeze.Thermodynamics: CondensedPhase
liquid_water = CondensedPhase(latent_heat=2500800, heat_capacity=4181)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CondensedPhase{Float64}(latent_heat=2.5008e6, heat_capacity=4181.0)</code></pre><p>or water ice,</p><pre><code class="language-julia hljs">water_ice = CondensedPhase(latent_heat=2834000, heat_capacity=2108)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CondensedPhase{Float64}(latent_heat=2.834e6, heat_capacity=2108.0)</code></pre><p>The saturation vapor pressure is</p><pre><code class="language-julia hljs">using Breeze
using Breeze.Thermodynamics: saturation_vapor_pressure

thermo = ThermodynamicConstants()

T = collect(200:0.1:320)
p·µõÀ°‚Å∫ = [saturation_vapor_pressure(T‚Å±, thermo, thermo.liquid) for T‚Å± in T]
p·µõ‚Å±‚Å∫ = [saturation_vapor_pressure(T‚Å±, thermo, thermo.solid) for T‚Å± in T]
p·µõ‚Å±‚Å∫[T .&gt; thermo.triple_point_temperature] .= NaN

using CairoMakie

fig = Figure()
ax = Axis(fig[1, 1], xlabel=&quot;Temperature (·µíK)&quot;, ylabel=&quot;Saturation vapor pressure p·µõ‚Å∫ (Pa)&quot;, yscale = log10, xticks=200:20:320)
lines!(ax, T, p·µõÀ°‚Å∫, label=&quot;vapor pressure over liquid&quot;)
lines!(ax, T, p·µõ‚Å±‚Å∫, linestyle=:dash, label=&quot;vapor pressure over ice&quot;)
axislegend(ax, position=:rb)
fig</code></pre><img src="73aa84ee.svg" alt="Example block output"/><p>The saturation specific humidity is</p><p class="math-container">\[q·µõ‚Å∫ ‚â° \frac{œÅ·µõ‚Å∫}{œÅ} = \frac{p·µõ‚Å∫}{œÅ R·µê T} .\]</p><p>and this is what it looks like:</p><pre><code class="language-julia hljs">using Breeze
using Breeze.MoistAirBuoyancies: saturation_specific_humidity

thermo = ThermodynamicConstants()
ref = ReferenceStateConstants(base_pressure=101325, potential_temperature=288)

z = 0
T = collect(273.2:0.1:313.2)
q·µõ‚Å∫ = [saturation_specific_humidity(T‚Å±, z, ref, thermo, thermo.liquid) for T‚Å± in T]

using CairoMakie

fig = Figure()
ax = Axis(fig[1, 1], xlabel=&quot;Temperature (·µíK)&quot;, ylabel=&quot;Saturation specific humidity q·µõ‚Å∫ (kg kg‚Åª¬π)&quot;)
lines!(ax, T, q·µõ‚Å∫)
fig</code></pre><img src="06345acb.svg" alt="Example block output"/><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><span>$\mathcal{H}$</span> is called <a href="https://en.wikipedia.org/wiki/Enthalpy"><em>enthalpy</em></a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><p>The conservation of energy states that any external heat input into the gas must equal the sum   of the change of the gas&#39;s internal energy and the work done by the gas, <span>$p \, \mathrm{d} V$</span>.   For atmospheric flows it&#39;s convenient to express everything per unit mass. Assuming the mass of   the fluid is conserved, we have that the work done per unit mass is <span>$p \, \mathrm{d}(\rho^{-1})$</span>   and the internal energy per unit mass is <span>$\mathcal{I} ‚â° c·µõ \mathrm{d} T$</span>.   Therefore, if <span>$\mathrm{d} \mathcal{H}$</span> is the change in heat content per unit mass,   we have:</p><p class="math-container">\[\mathrm{d} \mathcal{H} = c·µõ \mathrm{d} T + p \, \mathrm{d}(œÅ^{-1}) .\]</p><p>By utilizing the identity <span>$\mathrm{d}(p / œÅ) = p \, \mathrm{d}(œÅ^{-1}) + œÅ^{-1} \mathrm{d}p$</span> and using the ideal gas, we can rewrite the above conservation law as:</p><p class="math-container">\[\mathrm{d} \mathcal{H} = (c·µõ + R) \mathrm{d} T - œÅ^{-1} \mathrm{d}p ,\]</p><p>which is the expression in the main text after noting that the specific heat capacities under constant pressure and under constant volume are related via <span>$c·µñ ‚â° c·µõ + R$</span>.</p></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">¬´ Home</a><a class="docs-footer-nextpage" href="../microphysics/microphysics_overview/">Overview ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 6 November 2025 21:29">Thursday 6 November 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
